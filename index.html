<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coli Sphericus</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü¶†</text></svg>">
    <link rel="stylesheet" type="text/css" href="./web/style.css">
</head>
<body>

    <div id="control-panel">
        <button
            class="important-control"
            onclick="startDrawing()">
                –ú–∞–ª—é–π!
        </button>

        <button onclick="stopDrawing()">–°—Ç–æ–ø!</button>

        <button onclick="clearDrawing()">–û—á–∏—Å—Ç–∏—Ç–∏</button>

        <div>
            <span>—à–≤–∏–¥–∫—ñ—Å—Ç—å —Ä–æ—Å—Ç—É:</span>
            <input id="speed" type="number" name="v" value="1"/>
            <span>–º–º/—Å</span>
        </div>
    </div>

    <main>
        <canvas id="canvas" width="1000" height="1000">
            HTMl5 not supported.
        </canvas>
    </main>

    <script type="module">
        import {default as init_wasm, CircleDrawer} from './wasm/wasm.js';
        
        var drawer;
        
        async function load_wasm() {
            await init_wasm();
            drawer = new CircleDrawer();
        }
        load_wasm();
        
        function step() {
            drawer.draw();
        }
        
        window.drawingIntervalObject = null;
        window.startDrawing = function() {
            drawer.set_speed(
                Number.parseFloat(document.getElementById('speed').value)
            );
            if (window.drawingIntervalObject === null)
                window.drawingIntervalObject = setInterval(step, 100);
        };

        window.stopDrawing = function() {
            if (window.drawingIntervalObject !== null) {
                clearInterval(window.drawingIntervalObject);
                window.drawingIntervalObject = null;
            }
        };

        window.clearDrawing = function() {
            if (confirm("–¢–æ—á–Ω–æ –æ—á–∏—Å—Ç–∏—Ç–∏?"))
                drawer.clear();
        }
    </script>
</body>
</html>